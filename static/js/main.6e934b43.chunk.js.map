{"version":3,"sources":["utils/helper.js","utils/getWeb3.js","components/WithdrawPage.js","utils/AltBn128.js","assets/key.png","components/Web3StatusModal.js","components/DepositPage.js","components/StatusPage.js","App.js","serviceWorker.js","index.js"],"names":["__webpack_require__","d","__webpack_exports__","append0x","s","indexOf","Web3","require","resolveWeb3","resolve","options","isBrowser","provider","customProvider","window","ethereum","requestPermission","enable","web3","currentProvider","fallbackProvider","module","exports","arguments","length","undefined","Promise","isReactNative","navigator","product","document","readyState","addEventListener","bnZero","BN","WITHDRAWALSTATES","WithdrawPage","props","ws","dappGateway","_useState","useState","deposited","withdrawn","participantsRequired","_useState2","Object","_Users_joshjones_Downloads_heiswap_dapp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","ringParticipants","setRingParticipants","_useState3","_useState4","unknownErrorStr","setUnknownErrorStr","_useState5","_useState6","txReceipt","setTxReceipt","_useState7","_useState8","heiToken","setHeiToken","_useState9","_useState10","useRelayer","setUseRelayer","_useState11","_useState12","useDefaultRelayer","setUseDefaultRelayer","_useState13","_useState14","customerRelayerURL","setCustomRelayerURL","_useState15","_useState16","openModal","setOpenModal","_useState17","_useState18","withdrawalState","setWithdrawalState","noWeb3","noContractInstance","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","rimble_ui__WEBPACK_IMPORTED_MODULE_7__","style","width","mb","onSubmit","e","_Users_joshjones_Downloads_heiswap_dapp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_joshjones_Downloads_heiswap_dapp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","ethAddress","heiswapInstance","_heiToken$split$slice","_heiToken$split$slice2","ethAmount","ringIdx","randomSk","ringHash","ringHashBuf","ethAddressBuf","msgBuf","curParticipants","publicKeys","publicKeysBN","stealthSk","stealthPk","secretIdx","canSign","i","curPubKey","signature","c0","keyImage","dataBytecode","relayerURL","message","signedMessage","resp","respJson","errorMessage","gas","tx","txR","excStr","wrap","_context","prev","next","preventDefault","split","abrupt","slice","methods","getRingHash","call","sent","Buffer","from","concat","getRingMaxParticipants","getParticipants","getPublicKeys","map","x","filter","cmp","console","log","h1","serialize","bn128","ecMulG","ringSign","toString","withdraw","encodeABI","eth","personal","sign","axios","post","receiver","data","transactionHash","txHash","t0","response","estimateGas","to","_address","t1","t2","t3","t4","getTransactionCount","t5","nonce","sendTransaction","t6","stop","h3","fontSize","my","Field","label","Input","type","placeholder","required","value","onChange","target","textAlign","placement","Check","checked","height","disabled","alignItems","size","mr","name","italic","isOpen","maxWidth","p","Text","icononly","icon","color","position","top","right","mt","onClick","margin","bold","justifyContent","ml","Outline","bg","opts","seed","address","as","href","EC","crypto","soliditySha3","padLeft","P","N","A","G","bnOne","bnTwo","bnThree","curve","short","b","n","gRed","g","groupReduction","red","randomScalar","randomBytes","toRed","randomPoint","recurse","y2","redSqr","redMul","redIAdd","y","redSqrt","redSub","evalCurve","beta","mul","mod","add","powmod","scalarToPoint","_x","yP","_bn128$evalCurve","_bn128$evalCurve2","_Users_joshjones_Downloads_heiswap_dapp_master_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","ecAdd","point1","point2","p1","point","p2","fp","getX","getY","ecMul","secretKey","secretKeyIdx","z1","z2","keyCount","c","Array","fill","h","h2","yTilde","u","idx","_idx","forEach","sci","sub","ringVerify","_signature","clone","shiftedK","f","k","parseInt","Math","repeat","and","hexStr","arr","isArray","reduce","acc","isBuffer","StatusModal","setIsOpen","react_default","index_es","children","px","py","borderTop","borderColor","DepositPage","targetEthAmount","targetEthAddress","validEthAddress","slicedToArray","depForumParams","setDepForumParams","acknowledgeClose","heiTokenEst","heiTokenFinal","modalParams","setModalParams","asyncToGenerator","regenerator_default","estRingIdx","gasPrice","depositResult","depositEventRetVal","realRingIdx","getCurrentRingIdx","assign","getGasPrice","deposit","send","utils","toWei","gasLimit","events","Deposited","returnValues","validated","parentNode","classList","remove","borderBottom","variant","mx","StatusPage","invalidToken","maxParticipants","depositedParticipants","withdrawnParticipants","participants","blocksLeftForForceClose","getForceCloseBlocksLeft","HeiSwapApp","drizzleUtils","attempted","heiswapEvent$","setDappGateway","web3StatusModal","setweb3StatusModal","index","curTab","setCurTab","initDappGateway","_ref","accounts","getWeb3","createDrizzleUtils","getAccounts","getContractInstance","artifact","heiswapArtifact","createEvent$","currentAccount$","subscribe","apply","this","useEffect","_callee2","_context2","theme","background","minHeight","_callee3","_context3","truncate","m","role","aria-label","mainColor","components_DepositPage","components_StatusPage","Web3StatusModal","bottom","paddingTop","App","App_HeiSwapApp","Boolean","location","hostname","match","ReactDOM","render","src_App","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.6e934b43.chunk.js","sourcesContent":["// @flow\n\n// Appends 0x in front of hex strings so\n// it fits the solidity format\nconst append0x = (s: String): String => {\n  if (s.indexOf('0x') !== 0) {\n    return '0x' + s\n  }\n  return s\n}\n\nexport {\n  append0x\n}\n","// Extending https://github.com/trufflesuite/drizzle-utils/blob/master/packages/get-web3/index.js\n\nconst Web3 = require('web3')\n\nconst resolveWeb3 = (resolve, options, isBrowser) => {\n  let provider\n\n  if (options.customProvider) {\n    // use custom provider from options object\n    provider = options.customProvider\n  } else if (isBrowser && window.ethereum) {\n    // use `ethereum` object injected by MetaMask\n    provider = window.ethereum\n    if (options.requestPermission) window.ethereum.enable()\n  } else if (isBrowser && typeof window.web3 !== 'undefined') {\n    // use injected web3 object by legacy dapp browsers\n    provider = window.web3.currentProvider\n  } else if (options.fallbackProvider) {\n    // use fallback provider from options object\n    provider = options.fallbackProvider\n  }\n\n  const web3 = new Web3(provider)\n  resolve(web3)\n}\n\nconst getWeb3 = (options = {}) =>\n  new Promise(resolve => {\n    // handle server-side and React Native environments\n    const isReactNative =\n      typeof navigator !== 'undefined' && navigator.product === 'ReactNative'\n    const isNode = typeof window === 'undefined'\n    if (isNode || isReactNative) {\n      return resolveWeb3(resolve, options, false)\n    }\n\n    // if page is ready, resolve for web3 immediately\n    if (document.readyState === `complete`) {\n      return resolveWeb3(resolve, options, true)\n    }\n\n    // otherwise, resolve for web3 when page is done loading\n    return window.addEventListener('load', () =>\n      resolveWeb3(resolve, options, true)\n    )\n  })\n\nmodule.exports = getWeb3\n","// @flow\nimport BN from \"bn.js\";\nimport { Scalar, Point, serialize, h1, bn128 } from \"../utils/AltBn128\";\nimport { append0x } from \"../utils/helper\";\nimport React, { useState } from \"react\";\nimport {\n  Form,\n  Radio,\n  Field,\n  Flex,\n  Input,\n  Blockie,\n  EthAddress,\n  Link,\n  Icon,\n  Modal,\n  Flash,\n  Card,\n  Box,\n  Button,\n  Loader,\n  Text,\n  Heading,\n  Tooltip,\n} from \"rimble-ui\";\nimport { DappGateway } from \"../types/DappGateway\";\nimport axios from \"axios\";\n\n// BigNumber 0\nconst bnZero = new BN(\"0\", 10);\n\n// Possible states\nconst WITHDRAWALSTATES = {\n  RelayerUnreachable: -3,\n  UnknownError: -2,\n  Nothing: -1,\n  CorruptedToken: 0,\n  RingNotClosed: 1,\n  RingNotEnoughParticipantsToClose: 2,\n  ForceClosingRing: 3,\n  FailedCloseRing: 4,\n  SuccessCloseRing: 5,\n  InvalidRing: 6,\n  InvalidSignature: 7,\n  SignatureUsed: 8,\n  Withdrawn: 9,\n};\n\nconst WithdrawPage = (props: {\n  dappGateway: DappGateway,\n  noWeb3: Boolean,\n  noContractInstance: Boolean,\n}) => {\n  const { dappGateway } = props;\n\n  const [ringParticipants, setRingParticipants] = useState({\n    deposited: 0,\n    withdrawn: 0,\n    participantsRequired: 0,\n  });\n  const [unknownErrorStr, setUnknownErrorStr] = useState(\"\");\n  const [txReceipt, setTxReceipt] = useState(null);\n  const [heiToken, setHeiToken] = useState(\"\");\n  const [useRelayer, setUseRelayer] = useState(true);\n  const [useDefaultRelayer, setUseDefaultRelayer] = useState(true);\n  const [customerRelayerURL, setCustomRelayerURL] = useState(\"\");\n  const [openModal, setOpenModal] = useState(false);\n  const [withdrawalState, setWithdrawalState] = useState(\n    WITHDRAWALSTATES.Nothing\n  );\n\n  const { noWeb3, noContractInstance } = props;\n\n  const getModalDisplay = (ws) => {\n    if (ws === WITHDRAWALSTATES.Nothing) {\n      return (\n        <div>\n          <Loader style={{ margin: \"auto\" }} size=\"10rem\" />\n          <br />\n          <Text bold style={{ textAlign: \"center\" }}>\n            Withdrawing ETH...{\" \"}\n          </Text>\n          <Text style={{ textAlign: \"center\" }}>\n            Remember to confirm this withdrawal in your wallet.\n          </Text>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.ForceClosingRing) {\n      return (\n        <div>\n          <Box>\n            <Loader style={{ margin: \"auto\" }} size=\"10rem\" />\n            <br />\n            <Text bold style={{ textAlign: \"center\" }}>\n              Closing pool...\n            </Text>\n            <Text style={{ textAlign: \"center\" }}>\n              Remember to confirm this in your wallet.\n            </Text>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.CorruptedToken) {\n      return (\n        <div>\n          This token doesn't look right. Check you've pasted it correctly and\n          try again.\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.SuccessCloseRing) {\n      return (\n        <div>\n          <Box>\n            <Heading.h3 my=\"3\" fontSize=\"4\">\n              Pool closed\n            </Heading.h3>\n            <Text>Your ETH is now ready to withdraw.</Text>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.FailedCloseRing) {\n      return (\n        <div>\n          <Box>\n            <Heading.h3 my=\"3\" fontSize=\"4\">\n              Couldn't close pool\n            </Heading.h3>\n            <Text>\n              If you recently tried closing the pool, it may still be closing in\n              the background. Please wait a few minutes and try your withdrawal\n              again.\n            </Text>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.RingNotClosed) {\n      return (\n        <div>\n          <Box>\n            <Heading.h3 my=\"3\" fontSize=\"4\">\n              Not Enough Participants\n            </Heading.h3>\n            <Text>\n              To get your ETH, you'll need to wait for more participants to\n              join.{\" \"}\n            </Text>\n            <Flash my={3}>\n              The pool currently has {ringParticipants.deposited}/\n              {ringParticipants.participantsRequired} ETH participants(s).\n            </Flash>\n            <Flex mt={4} justifyContent=\"space-between\">\n              <Box ml={2} width={1 / 2}>\n                <Button.Outline onClick={() => setOpenModal(false)} width={1}>\n                  Wait\n                </Button.Outline>\n              </Box>\n            </Flex>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.RingNotEnoughParticipantsToClose) {\n      return (\n        <div>\n          <Box>\n            <Heading.h3 my=\"3\" fontSize=\"4\">\n              Couldn't close pool\n            </Heading.h3>\n            <Text>\n              There's not enough ETH in this pool right now to make your\n              withdrawal private. Please try again later.\n            </Text>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.InvalidRing) {\n      return <div>Invalid signature.</div>;\n    } else if (ws === WITHDRAWALSTATES.InvalidSignature) {\n      return (\n        <Box>\n          <Heading.h3 my={3} fontSize=\"4\">\n            Wrong account\n          </Heading.h3>\n          <Text>There's no ETH in the pool for:</Text>\n          <Flex p={3} bg=\"#DED9FC\" alignItems=\"center\" my={3}>\n            <Box mr={3}>\n              <Blockie opts={{ seed: dappGateway.ethAddress, size: 16 }} />\n            </Box>\n            <Box>\n              <EthAddress\n                ml={3}\n                fontSize=\"4\"\n                address={dappGateway.ethAddress}\n              />\n            </Box>\n          </Flex>\n          <Text>Try changing your Ethereum account.</Text>\n        </Box>\n      );\n    } else if (ws === WITHDRAWALSTATES.SignatureUsed) {\n      return (\n        <Box>\n          <Heading.h3 my={3} fontSize=\"4\">\n            Old token\n          </Heading.h3>\n          <Text>This token's already been used to withdraw ETH.</Text>\n        </Box>\n      );\n    } else if (ws === WITHDRAWALSTATES.Withdrawn) {\n      return (\n        <div>\n          <Box justifyContent=\"center\">\n            <Icon\n              style={{ margin: \"auto\" }}\n              size=\"80\"\n              mb={3}\n              color=\"#29B236\"\n              name=\"CheckCircle\"\n            />\n            <Heading.h3 textAlign=\"center\" mb={3}>\n              ETH withdrawn\n            </Heading.h3>\n            <Button.Text\n              textAlign=\"center\"\n              as=\"a\"\n              href={`https://ropsten.etherscan.io/tx/${txReceipt.transactionHash}`}\n            >\n              View on etherscan\n            </Button.Text>\n          </Box>\n        </div>\n      );\n    } else if (ws === WITHDRAWALSTATES.RelayerUnreachable) {\n      return (\n        <Box>\n          <Heading.h3 my={3} fontSize=\"4\">\n            Unable to reach relayer\n          </Heading.h3>\n          <Text>\n            Try using a different relayer, you can also{\" \"}\n            <a href=\"https://github.com/kendricktan/heiswap-relayer\">\n              setup your own relayer\n            </a>\n          </Text>\n        </Box>\n      );\n    }\n\n    return (\n      <Box>\n        <Heading.h3 my={3} fontSize=\"4\">\n          Unknown Error Occured\n        </Heading.h3>\n        <Text>\n          <a href=\"https://github.com/kendricktan/heiswap-dapp/issues\">\n            Please open a new issue with the error description below.\n          </a>\n          Description: {unknownErrorStr}\n        </Text>\n      </Box>\n    );\n  };\n\n  return (\n    <Box style={{ width: \"100%\" }} mb={6}>\n      <Form\n        onSubmit={(e) => {\n          (async () => {\n            e.preventDefault();\n\n            const { ethAddress, heiswapInstance, web3 } = dappGateway;\n\n            // Opens modal\n            setOpenModal(true);\n\n            // Invalid heiToken\n            if (heiToken.split(\"-\").length - 1 !== 3) {\n              setWithdrawalState(WITHDRAWALSTATES.CorruptedToken);\n              return;\n            }\n\n            // eslint-disable-next-line no-unused-vars\n            const [ethAmount, ringIdx, randomSk] = heiToken.split(\"-\").slice(1);\n\n            // Checks if ring is closed\n            const ringHash = await heiswapInstance.methods\n              .getRingHash(ethAmount, ringIdx)\n              .call();\n            const ringHashBuf = Buffer.from(\n              ringHash.slice(2), // Remove the '0x'\n              \"hex\"\n            );\n            const ethAddressBuf = Buffer.from(\n              ethAddress.slice(2), // Remove the '0x'\n              \"hex\"\n            );\n            const msgBuf = Buffer.concat([ringHashBuf, ethAddressBuf]);\n\n            // If ring hash isn't closed\n            // 32 bytes (64 chars + 2 chars ('0x')))\n            if (ringHash.length !== 66) {\n              const participantsRequired = await heiswapInstance.methods\n                .getRingMaxParticipants()\n                .call();\n\n              const curParticipants = await heiswapInstance.methods\n                .getParticipants(ethAmount, ringIdx)\n                .call();\n\n              setRingParticipants({\n                deposited: curParticipants[0],\n                withdrawn: curParticipants[1],\n                participantsRequired,\n              });\n\n              setWithdrawalState(WITHDRAWALSTATES.RingNotClosed);\n              return;\n            }\n\n            // Get Public Keys\n            // Don't want uninitialized keys\n            // Since solidity can't return dynamic arrays\n            const publicKeys: [[String, String]] = await heiswapInstance.methods\n              .getPublicKeys(ethAmount, ringIdx)\n              .call();\n\n            // Convert to array of Point\n            const publicKeysBN: [Point] = publicKeys\n              .map((x) => {\n                return [\n                  // Slice the '0x'\n                  new BN(Buffer.from(x[0].slice(2), \"hex\")),\n                  new BN(Buffer.from(x[1].slice(2), \"hex\")),\n                ];\n              })\n              .filter((x) => x[0].cmp(bnZero) !== 0 && x[1].cmp(bnZero) !== 0);\n\n            console.log(publicKeys);\n\n            // Check if user is able to generate any one of these public keys\n            const stealthSk: Scalar = h1(serialize([randomSk, ethAddress]));\n            const stealthPk: Point = bn128.ecMulG(stealthSk);\n\n            let secretIdx = 0;\n            let canSign = false;\n            for (let i = 0; i < publicKeysBN.length; i++) {\n              const curPubKey = publicKeysBN[i];\n\n              if (\n                curPubKey[0].cmp(stealthPk[0]) === 0 &&\n                curPubKey[1].cmp(stealthPk[1]) === 0\n              ) {\n                secretIdx = i;\n                canSign = true;\n                break;\n              }\n            }\n\n            if (!canSign) {\n              setWithdrawalState(WITHDRAWALSTATES.InvalidSignature);\n              return;\n            }\n\n            // Create signature\n            const signature = bn128.ringSign(\n              msgBuf,\n              publicKeysBN,\n              stealthSk,\n              secretIdx\n            );\n\n            // Create the transaction\n            const c0 = append0x(signature[0].toString(\"hex\"));\n            const s = signature[1].map((x) => append0x(x.toString(\"hex\")));\n            const keyImage = [\n              append0x(signature[2][0].toString(\"hex\")),\n              append0x(signature[2][1].toString(\"hex\")),\n            ];\n\n            const dataBytecode = heiswapInstance.methods\n              .withdraw(ethAddress, ethAmount, ringIdx, c0, keyImage, s)\n              .encodeABI();\n\n            // Just send the dataBytecode to a relayer\n            // TFW can't signTransaction with web3.eth.signTransaction\n            // web3 is so broken, the versioning is so fucked,\n            // the docs are so outdated. Fucking hell.\n            if (useRelayer) {\n              const relayerURL = useDefaultRelayer\n                ? \"https://relayer.heiswap.exchange\"\n                : customerRelayerURL;\n              try {\n                // Nicer user flow for withdrawal (has prompts to sign message even through relayer)\n                // Also safer since relayer knows address authorized it\n                const message = `Get Shiba from SOS via Relayer (Destination: ${dappGateway.ethAddress})`;\n\n                const signedMessage = await web3.eth.personal.sign(\n                  message,\n                  dappGateway.ethAddress\n                );\n\n                const resp = await axios.post(relayerURL, {\n                  message,\n                  signedMessage,\n                  receiver: ethAddress,\n                  ethAmount,\n                  ringIdx,\n                  c0,\n                  keyImage,\n                  s,\n                });\n\n                const respJson: { errorMessage: String, txHash: String } =\n                  resp.data;\n\n                setTxReceipt({ transactionHash: respJson.txHash });\n                setWithdrawalState(WITHDRAWALSTATES.Withdrawn);\n              } catch (exc) {\n                // Relayer unavailable\n                if (exc.response === undefined) {\n                  setWithdrawalState(WITHDRAWALSTATES.RelayerUnreachable);\n                  return;\n                }\n\n                const errorMessage = exc.response.data.errorMessage;\n                if (errorMessage.indexOf(\"invalid format\") !== -1) {\n                  setWithdrawalState(WITHDRAWALSTATES.CorruptedToken);\n                } else if (errorMessage.indexOf(\"EVM revert\") !== -1) {\n                  // EVM Revert is likely that the key image was used\n                  setWithdrawalState(WITHDRAWALSTATES.SignatureUsed);\n                } else if (\n                  errorMessage.indexOf(\"Invalid Message Signature\") !== -1 ||\n                  errorMessage.indexOf(\"Invalid Ring Signature\") !== -1\n                ) {\n                  setWithdrawalState(WITHDRAWALSTATES.InvalidSignature);\n                } else {\n                  setUnknownErrorStr(errorMessage);\n                  setWithdrawalState(WITHDRAWALSTATES.UnknownError);\n                }\n              }\n            } else {\n              // Broadcast the transaction otherwise\n              try {\n                const gas = await web3.eth.estimateGas({\n                  to: heiswapInstance._address,\n                  data: dataBytecode,\n                });\n\n                const tx = {\n                  from: ethAddress,\n                  to: heiswapInstance._address,\n                  gas,\n                  data: dataBytecode,\n                  nonce: await web3.eth.getTransactionCount(ethAddress),\n                };\n\n                const txR = await web3.eth.sendTransaction(tx);\n\n                setTxReceipt(txR);\n                setWithdrawalState(WITHDRAWALSTATES.Withdrawn);\n              } catch (exc) {\n                const excStr = exc.toString();\n\n                if (excStr.indexOf(\"Signature has been used!\") !== 0) {\n                  setWithdrawalState(WITHDRAWALSTATES.SignatureUsed);\n                } else if (excStr.indexOf(\"Invalid signature\") !== 0) {\n                  setWithdrawalState(WITHDRAWALSTATES.InvalidSignature);\n                } else if (excStr.indexOf(\"Pool isn't closed\") !== 0) {\n                  setWithdrawalState(WITHDRAWALSTATES.RingNotClosed);\n                } else if (excStr.indexOf(\"All ETH from current pool\") !== 0) {\n                  setWithdrawalState(WITHDRAWALSTATES.SignatureUsed);\n                } else {\n                  setUnknownErrorStr(excStr);\n                  setWithdrawalState(WITHDRAWALSTATES.UnknownError);\n                }\n              }\n            }\n          })();\n        }}\n        width=\"100%\"\n      >\n        <Card>\n          <Heading.h3 fontSize=\"3\">Get Shiba</Heading.h3>\n          <Text my=\"3\">\n            Paste your SOS token to see if your Shiba is ready to withdraw\n            privately.\n          </Text>\n\n          <Form.Field label=\"SOS token\" width={1}>\n            <Form.Input\n              type=\"text\"\n              placeholder=\"e.g. sos-x-xx-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n              required\n              width={1}\n              value={heiToken}\n              onChange={(e) => setHeiToken(e.target.value)}\n            />\n          </Form.Field>\n          <Box textAlign=\"right\">\n            <Tooltip\n              message=\"Whoever deposited your Shiba should have your SOS token\"\n              placement=\"bottom\"\n            >\n              <Link>I don't have a token</Link>\n            </Tooltip>\n          </Box>\n          <Box my=\"3\">\n            <Form.Check\n              checked={useRelayer}\n              label={`Use relayer to withdraw`}\n              mb={3}\n              onChange={(e) => setUseRelayer(e.target.checked)}\n            />\n          </Box>\n          <Box my=\"3\">\n            {useRelayer ? (\n              <div>\n                <Field label=\"Select your relayer\">\n                  <div>\n                    <Radio\n                      label=\"Default - relayer.sos.exchange\"\n                      my=\"1\"\n                      checked={useDefaultRelayer}\n                      onChange={(e) => setUseDefaultRelayer(e.target.checked)}\n                    />\n                    <Radio\n                      label=\"Custom\"\n                      my=\"1\"\n                      checked={!useDefaultRelayer}\n                      onChange={(e) => setUseDefaultRelayer(!e.target.checked)}\n                    />\n                    <Input\n                      placeholder=\"http://myrelayer.com:3000\"\n                      height=\"2rem\"\n                      disabled={useDefaultRelayer}\n                      width={1}\n                      value={customerRelayerURL}\n                      onChange={(e) => setCustomRelayerURL(e.target.value)}\n                    />\n                  </div>\n                </Field>\n                <Flex alignItems=\"center\" my=\"3\">\n                  <Box>\n                    <Icon size=\"20\" mr={1} name=\"Info\" />\n                  </Box>\n                  <Box>\n                    <Text italic>\n                      You will pay a small amount of fees (BONE) to the relayer\n                      for GAS purposes.\n                    </Text>\n                  </Box>\n                </Flex>\n              </div>\n            ) : (\n              <Flex alignItems=\"center\" my=\"3\">\n                <Box>\n                  <Icon size=\"20\" mr={1} name=\"Info\" />\n                </Box>\n                <Box>\n                  <Text italic>\n                    You will need some BONE in your withdrawal address to pay\n                    for GAS.\n                  </Text>\n                </Box>\n              </Flex>\n            )}\n          </Box>\n          <Button\n            type=\"submit\"\n            width={1}\n            disabled={noWeb3 || noContractInstance}\n          >\n            Withdraw Shiba\n          </Button>\n        </Card>\n      </Form>\n\n      <Modal isOpen={openModal}>\n        <Card style={{ maxWidth: \"620px\" }} p={0}>\n          <Button.Text\n            icononly\n            icon={\"Close\"}\n            color={\"moon-gray\"}\n            position={\"absolute\"}\n            top={0}\n            right={0}\n            mt={3}\n            mr={3}\n            onClick={() => {\n              setOpenModal(false);\n              setWithdrawalState(WITHDRAWALSTATES.Nothing);\n            }}\n          />\n\n          <Box p={4} mb={3}>\n            {getModalDisplay(withdrawalState)}\n          </Box>\n        </Card>\n      </Modal>\n    </Box>\n  );\n};\n\nexport default WithdrawPage;\n","// @flow\n\n/*\n * alt_bn_128 curve in JavaScript\n * Referenced https://github.com/AztecProtocol/aztec-crypto-js/blob/master/bn128/bn128.js\n */\n\nconst EC = require('elliptic')\nconst crypto = require('crypto')\nconst BN = require('bn.js')\nconst { soliditySha3, padLeft } = require('web3-utils')\n\n// Types\n// Since JS doesn't handle BigInteger well,\n// the scalar representation will be the a BN object\nexport type Scalar = BN;\nexport type Point = [Scalar, Scalar];\nexport type Signature = [Scalar, Array<Scalar>, Point];\n\n// AltBn128 field properties\nconst P: Scalar = new BN(\n  '21888242871839275222246405745257275088696311157297823662689037894645226208583',\n  10\n)\nconst N = new BN(\n  '21888242871839275222246405745257275088548364400416034343698204186575808495617',\n  10\n)\nconst A = new BN(\n  '5472060717959818805561601436314318772174077789324455915672259473661306552146',\n  10\n)\nconst G = [new BN(1, 10), new BN(2, 10)]\n\n// Convinience Numbers\nconst bnOne = new BN('1', 10)\nconst bnTwo = new BN('2', 10)\nconst bnThree = new BN('3', 10)\n\n// AltBn128 Object\nconst bn128 = {}\n\n// ECC Curve\nbn128.curve = new EC.curve.short({\n  a: '0',\n  b: '3',\n  p: P,\n  n: N,\n  gRed: false,\n  g: G\n})\n\n/**\n *  BN.js reduction context for bn128 curve group's prime modulus.\n */\nbn128.groupReduction = BN.red(bn128.curve.n)\n\n/**\n * Gets a random Scalar.\n */\nbn128.randomScalar = (): Scalar => {\n  return new BN(crypto.randomBytes(32), 16).toRed(bn128.groupReduction)\n}\n\n/**\n * Gets a random Point on curve.\n */\nbn128.randomPoint = (): Point => {\n  const recurse = () => {\n    const x = new BN(crypto.randomBytes(32), 16).toRed(bn128.curve.red)\n    const y2 = x\n      .redSqr()\n      .redMul(x)\n      .redIAdd(bn128.curve.b)\n    const y = y2.redSqrt()\n    if (\n      y\n        .redSqr(y)\n        .redSub(y2)\n        .cmp(bn128.curve.a)\n    ) {\n      return recurse()\n    }\n    return [x, y]\n  }\n  return recurse()\n}\n\n/**\n *  Returns (beta, y) given x\n *\n *  Beta is used to calculate if the Point exists on the curve\n */\nbn128.evalCurve = (x: Scalar): [Scalar, Scalar] => {\n  const beta = x\n    .mul(x)\n    .mod(P)\n    .mul(x)\n    .mod(P)\n    .add(bnThree)\n    .mod(P)\n  const y = powmod(beta, A, P)\n\n  return [beta, y]\n}\n\n/**\n *  Calculates a Point given a Scalar\n */\nbn128.scalarToPoint = (_x: Scalar): Point => {\n  let x = _x.mod(N)\n\n  let beta, y, yP\n\n  while (true) {\n    [beta, y] = bn128.evalCurve(x)\n    yP = y.mul(y).mod(P)\n\n    if (beta.cmp(yP) === 0) {\n      return [x, y]\n    }\n    x = x.add(bnOne).mod(N)\n  }\n}\n\n/**\n *  ECC addition operation\n */\nbn128.ecAdd = (point1: Point, point2: Point): Point => {\n  const p1 = bn128.curve.point(point1[0], point1[1])\n  const p2 = bn128.curve.point(point2[0], point2[1])\n  const fp = p1.add(p2)\n\n  return [fp.getX(), fp.getY()]\n}\n\n/**\n * ECC multiplication operation\n */\nbn128.ecMul = (p: Point, s: Scalar): Point => {\n  const fp = bn128.curve.point(p[0], p[1]).mul(s)\n\n  return [fp.getX(), fp.getY()]\n}\n\n/**\n * ECC multiplication operation for G\n */\nbn128.ecMulG = (s: Scalar): Point => {\n  return bn128.ecMul(G, s)\n}\n\n/**\n * Ring signature generation\n */\nbn128.ringSign = (\n  message: String,\n  publicKeys: Array<Point>,\n  secretKey: Scalar,\n  secretKeyIdx: int\n): Signature => {\n  const keyCount: int = publicKeys.length\n\n  let c: Array<Scalar> = Array(keyCount).fill(new BN(0, 10))\n  let s: Array<Scalar> = Array(keyCount).fill(new BN(0, 10))\n\n  // Step 1\n  let h: Point = h2(serialize(publicKeys))\n  let yTilde = bn128.ecMul(h, secretKey)\n\n  // Step 2\n  let u = bn128.randomScalar()\n  c[(secretKeyIdx + 1) % keyCount] = h1(\n    serialize([\n      publicKeys,\n      yTilde,\n      message,\n      bn128.ecMul(G, u),\n      bn128.ecMul(h, u)\n    ])\n  )\n\n  // Step 3\n  const indexes = Array(keyCount)\n    .fill(0)\n    .map((x, idx) => idx)\n    .slice(secretKeyIdx + 1, keyCount)\n    .concat(\n      Array(secretKeyIdx)\n        .fill(0)\n        .map((_x, _idx) => _idx)\n    )\n\n  let z1, z2\n\n  indexes.forEach(i => {\n    s[i] = bn128.randomScalar()\n\n    z1 = bn128.ecAdd(bn128.ecMul(G, s[i]), bn128.ecMul(publicKeys[i], c[i]))\n    z2 = bn128.ecAdd(bn128.ecMul(h, s[i]), bn128.ecMul(yTilde, c[i]))\n\n    c[(i + 1) % keyCount] = h1(\n      serialize([publicKeys, yTilde, message, z1, z2])\n    )\n  })\n\n  // Step 4\n  const sci = secretKey.mul(c[secretKeyIdx]).mod(N)\n\n  s[secretKeyIdx] = u.sub(sci)\n\n  // JavaScript negative modulo bug -_-\n  if (s[secretKeyIdx] < 0) {\n    s[secretKeyIdx] = s[secretKeyIdx].add(N)\n  }\n\n  s[secretKeyIdx] = s[secretKeyIdx].mod(N)\n\n  return [c[0], s, yTilde]\n}\n\n/**\n *  Ring signature verification\n */\nbn128.ringVerify = (\n  message: String,\n  publicKeys: Array<Point>,\n  signature: Signature\n): Boolean => {\n  const keyCount = publicKeys.length\n\n  const [c0, s, yTilde] = signature\n  let c = c0.clone()\n\n  // Step 1\n  const h = h2(serialize(publicKeys))\n\n  let z1, z2\n\n  for (let i = 0; i < keyCount; i++) {\n    z1 = bn128.ecAdd(bn128.ecMul(G, s[i]), bn128.ecMul(publicKeys[i], c))\n    z2 = bn128.ecAdd(bn128.ecMul(h, s[i]), bn128.ecMul(yTilde, c))\n\n    if (i < keyCount - 1) {\n      c = h1(serialize([publicKeys, yTilde, message, z1, z2]))\n    }\n  }\n\n  return c0.cmp(h1(serialize([publicKeys, yTilde, message, z1, z2]))) === 0\n}\n\n/* Helper Functions */\n\n/**\n *  Efficient powmod implementation.\n *\n *  Reference: https://gist.github.com/HarryR/a6d56a97ba7f1a4ebc43a40ca0f34044#file-longsigh-py-L26\n *  Returns (a^b) % n\n */\nconst powmod = (a: Scalar, b: Scalar, n: Scalar): Scalar => {\n  let c = new BN('0', 10)\n  let f = new BN('1', 10)\n  let k = new BN(parseInt(Math.log(b) / Math.log(2)), 10)\n\n  let shiftedK\n\n  while (k >= 0) {\n    c = c.mul(bnTwo)\n    f = f.mul(f).mod(n)\n\n    shiftedK = new BN('1' + '0'.repeat(k), 2)\n\n    if (b.and(shiftedK) > 0) {\n      c = c.add(bnOne)\n      f = f.mul(a).mod(n)\n    }\n\n    k = k.sub(bnOne)\n  }\n\n  return f\n}\n\n/**\n * Returns a Scalar repreesntation of the hash of the input.\n */\nconst h1 = (s: String): Scalar => {\n  // Want to be compatible with the solidity implementation\n  // which prepends \"0x\" by default\n  if (s.indexOf('0x') !== 0) {\n    s = '0x' + s\n  }\n\n  const h = soliditySha3(s).slice(2) // Remove the \"0x\"\n  const b = new BN(h, 16)\n\n  return b.mod(N)\n}\n\n/**\n * Returns ECC Point of the Scalar representation of the hash\n * of the input.\n */\nconst h2 = (hexStr: String): Point => {\n  // Note: hexStr should be a string in hexadecimal format!\n  return bn128.scalarToPoint(h1(hexStr))\n}\n\n/**\n * Serializes the inputs into a hex string\n */\nconst serialize = (arr: Array<any>): String => {\n  if (!Array.isArray(arr)) {\n    // eslint-disable-next-line no-throw-literal\n    throw 'arr should be of type array'\n  }\n\n  return arr.reduce((acc, x) => {\n    if (typeof x === 'string') {\n      acc = acc + Buffer.from(x).toString('hex')\n    } else if (Array.isArray(x)) {\n      acc = acc + serialize(x)\n    } else if (Buffer.isBuffer(x)) {\n      acc = acc + x.toString('hex')\n    } else if (x.getX !== undefined && x.getY !== undefined) {\n      // Point\n      acc = acc + padLeft(x.getX().toString(16), 64, '0')\n      acc = acc + padLeft(x.getY().toString(16), 64, '0')\n    } else if (x.toString !== undefined) {\n      acc = acc + padLeft(x.toString(16), 64, '0')\n    }\n\n    return acc\n  }, '')\n}\n\n// For testing purposes\n// let secretNum = 4;\n// let message = \"ETH for you and everyone!\";\n// let secretKeys = Array(secretNum).fill(0).map(() => bn128.randomScalar());\n// let publicKeys = secretKeys.map(x => bn128.ecMul(G, x));\n// let signIdx = 1;\n// let signKey = secretKeys[signIdx];\n// let signature = bn128.ringSign(message, publicKeys, signKey, signIdx);\n// console.log(\"Signature verification: \", bn128.verify(message, publicKeys, signature))\n\n// // Print out for easier verification\n// // Pass the params to the python \"verify\" function and it should return True\n// console.log(\"--public keys--\");\n// console.log(\"[\");\n// publicKeys.map(x => {\n//   console.log(\"[\" + x[0].toString(10) + \", \" + x[1].toString(10) + \"],\");\n// });\n// console.log(\"]\");\n// console.log(\"--signature--\");\n// console.log(\"[\" + signature[0].toString(10) + \", [\");\n// signature[1].map(x => {\n//   console.log(x + \",\");\n// });\n// console.log(\"],[\");\n// console.log(signature[2][0].toString(10) + \", \" + signature[2][1].toString(10));\n// console.log(\"]]\");\n\nexport {\n  bn128,\n  powmod,\n  h1,\n  h2,\n  serialize\n}\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjBhsJMSCmvvpHAAADz0lEQVRo3u2XTWhUVxTHf5lpazSOWpGZJCYlbfyCRCH4hSghhEKhCFK02aXVblotuKih4lL82ERKd3ahhRZU1IiWttr6kW4Kmhi1o6XBRBpFYjOx1OkoJjMm81y84/O9d2f6MnfmJV3MvYt75/7PPf//PffjvCmhECXAOlpYxWICJOmnm6N0CVZNK40so5Qy7nCL03zP04KwWqWJaxhK7WY1Eb5lXEGG2corhSIvYQ/pDPQGBuM8zoIYXGRuYQQctjlNcosLRBlV6NLcoZMrxG1jfxRCwk7L3QCbKZPREJu5ayEj7KFakADNXLJFIc+NWEhKXJ1khgMJctOiSbHQNW87Y4JtzU/AcXHzI0EXssWxASeUmdsFibmE51TmksTAIE5YwS4LwTMMDMaYp1i82IgWfQGt4uKAgkTk6g3wldh8qNi8LcixgLaAemm/U5DlmF5PclxGVio2nSQAWKovoEbaXgWplLafPulVKDZpbpte9AUY0iYV5MXBesIT14i9mPPS+gIS0lYpyF/SVlv3P5ZhvjnvX/2nICptE71AKc00M595/MOrFjIivXq+IcIog/TwAw+BN2ULozlxOsoyOcfXmc3ejK/+GH0ZM0QHi9gvvz7XFwA94iSRNeVkqylG5J2ozEfA+zkTu+vX+dADnHck2I3UEuIt3uMnB81tPqWOWVTSxEF5Hc3IhckrHwUpt/1azQOqiBGhgTUOu1rWE+I+M1nEuzbGMmoYzmf92/Legiv50JfYcn6uNWrNXaEvYIUnTdx1Fsyr+SsfEOAj+f2F/hl4x9Oig7NidYYjVPCYGD08FOwgrwEr9QVUeVpErXdulA4XlqCfOmCJfi4Ie1oMW2c80+fnIwCm6wsY87SIEJHe3xnQOQCk9LdgwNOigSHpDSpYiMUA9OkLCHpabOQN6V1SsBbJmV2eXrKUthxufZxprtll3BNsrf/0BruV2J0S5Col/tMnmOWYXcE5QdI0+k9vYHCDbdTxOmGa+NL29bB7cuiz1UM64c+NPur4XrDXJDv8Xv2ffEIQ2ES3CxnlGLUvnU48DG20/yfeTpwFhIjxgHPcsCH1NNLAbMa5x03OEtdZ/WceK96l47RIX6Qv0hfpi/T/S3qvjJdi/VSu3szlG6aS3kcJE6X3SUIu9D5ImPjHVif3pXdX+bsxCav/menUMIDBEHVTQw9QQ1fh6KF9wvSlhSN1ln05rN6nkjkKQ1bvN/9Wnz0Kuwjzu/TTfOy3ALcEM+VMsoSXG9FmjZXTK2ODzJysKDgTrhmFAt57ryi0KWPl/MISvwifAzVDed0VaYEiAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA2LTI3VDA3OjQ5OjMyKzAyOjAw4q3+/wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNi0yN1QwNzo0OTozMiswMjowMJPwRkMAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC\"","// @flow\nimport React from 'react'\nimport {\n  Flex,\n  Box,\n  Button,\n  Modal,\n  Card\n} from 'rimble-ui'\n\ntype ModalProps = {\n  isOpen: Boolean,\n  setIsOpen: Function<Boolean>,\n  children: any\n}\n\nconst StatusModal = (props: ModalProps) => {\n  const { isOpen, setIsOpen } = props\n\n  return (\n    <Modal isOpen={isOpen}>\n      <Card style={{ maxWidth: '620px' }} p={0}>\n        <Button.Text\n          icononly\n          icon={'Close'}\n          color={'moon-gray'}\n          position={'absolute'}\n          top={0}\n          right={0}\n          mt={3}\n          mr={3}\n          onClick={() => setIsOpen(false)}\n        />\n\n        <Box p={4} mb={3}>\n          { props.children }\n        </Box>\n\n        <Flex\n          px={4}\n          py={3}\n          borderTop={1}\n          borderColor={'#E8E8E8'}\n          justifyContent={'flex-end'}\n        >\n          <Button.Outline onClick={() => setIsOpen(false)}>\n            Close\n          </Button.Outline>\n        </Flex>\n      </Card>\n    </Modal>\n  )\n}\n\nexport default StatusModal\n","// @flow\nimport crypto from \"crypto\";\nimport React, { useState } from \"react\";\nimport {\n  Loader,\n  Card,\n  Form,\n  Icon,\n  Box,\n  Flash,\n  Modal,\n  Select,\n  Text,\n  Button,\n  Checkbox,\n  PublicAddress,\n  Heading,\n  Flex,\n  Input,\n} from \"rimble-ui\";\nimport { serialize, h1, bn128 } from \"../utils/AltBn128\";\nimport { DappGateway } from \"../types/DappGateway\";\n\ntype DepositForumParams = {\n  targetEthAmount: Number,\n  targetEthAddress: String,\n  validEthAddress: Boolean,\n};\n\ntype ModalParams = {\n  isOpen: Boolean,\n  heiToken: String,\n  acknowledgeClose: Boolean,\n};\n\nconst DepositPage = (props: {\n  dappGateway: DappGateway,\n  noWeb3: Boolean,\n  noContractInstance: Boolean,\n}) => {\n  const { dappGateway } = props;\n\n  // Form validation\n  const [depForumParams: DepositForumParams, setDepForumParams] = useState({\n    targetEthAmount: 2,\n    targetEthAddress: \"\",\n    validEthAddress: false,\n  });\n\n  // Modal to preview progress\n  const [modalParams: ModalParams, setModalParams] = useState({\n    isOpen: false,\n    acknowledgeClose: false,\n    txHash: null, // transaction hash\n    heiTokenEst: null, // Estimate what the hei-token will be\n    heiTokenFinal: null, // The real hei-token generated from the contract's ret value firing\n  });\n\n  // Disable buttons etc if web3 isn't injected\n  const { noWeb3, noContractInstance } = props;\n\n  return (\n    <Box style={{ width: \"100%\" }} mb={6}>\n      <Form\n        onSubmit={(e) => {\n          (async () => {\n            // No refresh\n            e.preventDefault();\n\n            const { targetEthAmount, targetEthAddress } = depForumParams;\n            const { ethAddress, heiswapInstance, web3 } = dappGateway;\n\n            // Generaete a burner secret key\n            // and create a pseudo stealth address\n            const randomSk = crypto.randomBytes(32).toString(\"hex\");\n            const stealthSk = h1(serialize([randomSk, targetEthAddress]));\n\n            // Opens modal\n            const estRingIdx = await heiswapInstance.methods\n              .getCurrentRingIdx(targetEthAmount)\n              .call();\n\n            const heiTokenEst = `hei-${targetEthAmount}-${estRingIdx}-${randomSk}`;\n            // Make sure to set heiTokenFinal to null\n            setModalParams(\n              Object.assign({}, modalParams, {\n                isOpen: true,\n                heiTokenEst,\n                heiTokenFinal: null,\n              })\n            );\n\n            // Append \"0x\" in front of it, web3 requires it\n            const stealthPk = bn128\n              .ecMulG(stealthSk)\n              .map((x) => \"0x\" + x.toString(16));\n\n            // Deposit into Ring\n            try {\n              const gasPrice = await web3.eth.getGasPrice();\n\n              const depositResult = await heiswapInstance.methods\n                .deposit(stealthPk)\n                .send({\n                  from: ethAddress,\n                  value: web3.utils.toWei(\n                    targetEthAmount.toString(10),\n                    \"ether\"\n                  ),\n                  gasLimit: \"800000\",\n                  gasPrice,\n                });\n\n              // Get event return value\n              const depositEventRetVal =\n                depositResult.events.Deposited.returnValues;\n\n              // Used to get the index of the ring\n              const realRingIdx = depositEventRetVal.idx;\n\n              // Generate token\n              // Format is \"hei-<ether-amount>-<idx>-<randomSk>\"\n              const heiTokenFinal = `hei-${targetEthAmount}-${realRingIdx}-${randomSk}`;\n\n              setModalParams(\n                Object.assign(modalParams, {\n                  isOpen: true,\n                  heiTokenFinal,\n                  txHash: depositResult.transactionHash,\n                })\n              );\n            } catch (exc) {\n              // TODO: Handle Exception\n            }\n          })();\n        }}\n        width=\"100%\"\n      >\n        <Card>\n          <Heading.h3 mb={3} fontSize=\"3\">\n            Send Shiba\n          </Heading.h3>\n          {/* }<Flex>\n              <Box width={1/2} mx={2}>\n              <Flex>\n              <Box mr={1}>\n              <Icon name=\"CheckCircle\" />\n              </Box>\n              <Box>\n              <Text fontSize=\"1\">Deposit ETH and get a token</Text>\n              </Box>\n              </Flex>\n              </Box>\n              <Box width={1/2} mx={2}>\n              <Flex>\n              <Box mr={1}>\n              <Icon name=\"CheckCircle\" />\n              </Box>\n              <Box>\n              <Text fontSize=\"1\">Share the token with your recipient</Text>\n              </Box>\n              </Flex>\n              </Box>\n        </Flex> */}\n          <Text my=\"3\">\n            Deposit your Shiba into the pool and get a token that represents the\n            same value. That token can be used by the recipient address to\n            withdraw your deposit.\n          </Text>\n          <Form.Field\n            validated={depForumParams.validEthAddress}\n            label=\"Recipient Shibarium address\"\n            width={1}\n          >\n            <Form.Input\n              type=\"text\"\n              placeholder=\"e.g. 0x53Nd...2Eth\"\n              required\n              width={1}\n              value={depForumParams.targetEthAddress}\n              onChange={(e) => {\n                // For the little checkmark\n                if (\n                  e.target.value.indexOf(\"0x\") === 0 &&\n                  e.target.value.length === 42\n                ) {\n                  e.target.parentNode.classList.add(\"was-validated\");\n                } else {\n                  e.target.parentNode.classList.remove(\"was-validated\");\n                }\n\n                setDepForumParams(\n                  Object.assign({}, depForumParams, {\n                    targetEthAddress: e.target.value,\n                    validEthAddress:\n                      e.target.value.indexOf(\"0x\") === 0 &&\n                      e.target.value.length === 42,\n                  })\n                );\n              }}\n            />\n          </Form.Field>\n          <Form.Field label=\"Shiba amount\" width={1}>\n            <Input\n              placeholder=\"e.g. 5,000,000\"\n              required\n              width={1}\n              onChange={(e) => {\n                setDepForumParams(\n                  Object.assign({}, depForumParams, {\n                    targetEthAmount: e.target.value,\n                  })\n                );\n              }}\n            />\n          </Form.Field>\n          <Flex alignItems=\"center\" my=\"3\">\n            <Box>\n              <Icon size=\"20\" mr={1} name=\"Info\" />\n            </Box>\n            <Box>\n              <Text italic>\n                You will need to pay a small transaction fee to deposit Shiba.\n              </Text>\n            </Box>\n          </Flex>\n\n          <Button\n            type=\"submit\"\n            width={1}\n            disabled={\n              noWeb3 || noContractInstance || !depForumParams.validEthAddress\n            }\n          >\n            Deposit Shiba\n          </Button>\n        </Card>\n      </Form>\n\n      <Modal isOpen={modalParams.isOpen}>\n        <Card style={{ maxWidth: \"620px\" }} p={0}>\n          <Box p={4} mb={3}>\n            <div>\n              {modalParams.heiTokenFinal === null ? (\n                <Loader style={{ margin: \"auto\" }} size=\"10rem\" />\n              ) : (\n                <Icon\n                  style={{ margin: \"auto\" }}\n                  color=\"#29B236\"\n                  size=\"80\"\n                  name=\"CheckCircle\"\n                />\n              )}\n\n              <br />\n              <Text\n                py={3}\n                borderBottom={1}\n                borderColor={\"#E8E8E8\"}\n                mb=\"3\"\n                style={{ textAlign: \"center\" }}\n              >\n                {modalParams.heiTokenFinal === null ? (\n                  \"Depositing ETH... make sure you have confirmed the deposit in your wallet\"\n                ) : (\n                  <a\n                    href={`https://ropsten.etherscan.io/tx/${modalParams.txHash}`}\n                  >\n                    ETH deposited!\n                  </a>\n                )}\n              </Text>\n\n              <Heading.h3 my=\"3\" fontSize=\"3\">\n                Next up\n              </Heading.h3>\n              <Text>\n                Send this token to your recipient. They'll need it to withdraw\n                their funds.{\" \"}\n              </Text>\n              <br />\n\n              <PublicAddress\n                width={1}\n                label=\"Hei token\"\n                address={\n                  modalParams.heiTokenFinal === null\n                    ? modalParams.heiTokenEst\n                    : modalParams.heiTokenFinal\n                }\n                onChange={() => {}}\n              />\n            </div>\n            <Box>\n              <Flash mb={3} variant=\"warning\">\n                <Flex alignItems=\"center\">\n                  <Box mr={1}>\n                    <Icon name=\"Warning\" />\n                  </Box>\n                  <Box mx={3}>\n                    There is no way to recover a lost token. If you lose this\n                    token, you'll lose your ETH.\n                  </Box>\n                </Flex>\n              </Flash>\n              <Checkbox\n                label=\"I have saved/sent the Hei token\"\n                mb={3}\n                onChange={(e) => {\n                  setModalParams(\n                    Object.assign({}, modalParams, {\n                      acknowledgeClose: e.target.checked,\n                    })\n                  );\n                }}\n              />\n              {modalParams.acknowledgeClose ? (\n                <Button\n                  position={\"absolute\"}\n                  top={0}\n                  width={1}\n                  onClick={() => {\n                    // Only allow close if tx is complete\n                    // and user acknowledged close\n                    if (\n                      modalParams.heiToken !== null &&\n                      modalParams.acknowledgeClose\n                    ) {\n                      setModalParams(\n                        Object.assign({}, modalParams, { isOpen: false })\n                      );\n                    }\n                  }}\n                >\n                  Close\n                </Button>\n              ) : (\n                <Button.Outline\n                  position={\"absolute\"}\n                  top={0}\n                  width={1}\n                  disabled\n                >\n                  Confirm you've copied the token\n                </Button.Outline>\n              )}\n            </Box>\n          </Box>\n        </Card>\n      </Modal>\n    </Box>\n  );\n};\n\nexport default DepositPage;\n","// @flow\nimport React, { useState } from 'react'\nimport { Form, Button, Modal, Card, Box, Loader, Text, Pill } from 'rimble-ui'\nimport { DappGateway } from '../types/DappGateway'\n\ntype StatusPageModalParams = {\n  isOpen: Boolean,\n  invalidToken: Boolean,\n  ringHash: String,\n  maxParticipants: Number,\n  depositedParticipants: Number,\n  withdrawnParticipants: Number,\n  blocksLeftForForceClose: Number\n}\n\nconst StatusPage = (props: { dappGateway: DappGateway, noWeb3: Boolean, noContractInstance: Boolean }) => {\n  const { dappGateway } = props\n\n  const [heiToken, setHeiToken] = useState('')\n\n  const [modalParams: StatusPageModalParams, setModalParams] = useState({\n    isOpen: false,\n    invalidToken: false,\n    ringHash: null,\n    maxParticipants: null,\n    depositedParticipants: null,\n    withdrawnParticipants: null\n  })\n\n  // Disable buttons etc if web3 isn't injected\n  const { noWeb3, noContractInstance } = props\n\n  return (\n    <div style={{ width: '100%' }}>\n      <Form onSubmit={(e) => {\n        (async () => {\n          e.preventDefault()\n\n          // Invalid heiToken\n          if (heiToken.split('-').length - 1 !== 3) {\n            setModalParams(Object.assign({}, modalParams, { isOpen: true, invalidToken: true }))\n            return\n          }\n\n          // Opens modal to display spinny progress bar\n          setModalParams(Object.assign({}, modalParams, {\n            isOpen: true,\n            invalidToken: false,\n            maxParticipants: null,\n            depositedParticipants: null,\n            withdrawnParticipants: null,\n            blocksLeftForForceClose: null\n          }))\n\n          const { heiswapInstance } = dappGateway\n\n          // eslint-disable-next-line no-unused-vars\n          const [ethAmount, ringIdx, randomSk] = heiToken.split('-').slice(1)\n\n          // Deposited Participants, Withdrawn Participants\n          const participants: [Number, Number] = await heiswapInstance\n            .methods\n            .getParticipants(ethAmount, ringIdx)\n            .call()\n\n          const maxParticipants: Number = await heiswapInstance\n            .methods\n            .getRingMaxParticipants()\n            .call()\n\n          const blocksLeftForForceClose: Number = await heiswapInstance\n            .methods\n            .getForceCloseBlocksLeft(ethAmount, ringIdx)\n            .call()\n          \n          const ringHash = await heiswapInstance\n            .methods\n            .getRingHash(ethAmount, ringIdx)\n            .call()\n\n          // Yay display modal status\n          setModalParams(Object.assign({}, modalParams, {\n            isOpen: true,\n            invalidToken: false,\n            ringHash,\n            maxParticipants: parseInt(maxParticipants),\n            depositedParticipants: parseInt(participants[0]),\n            withdrawnParticipants: parseInt(participants[1]),\n            blocksLeftForForceClose: parseInt(blocksLeftForForceClose)\n          }))\n        })()\n      }} width='100%'>\n        <Form.Field label='Token' width={1}>\n          <Form.Input\n            type='text'\n            placeholder='hei-x-x-xxxxxx'\n            required\n            width={1}\n            value={heiToken}\n            onChange={(e) => setHeiToken(e.target.value)}\n          />\n        </Form.Field>\n        <Button type='submit'width={1} disabled={noWeb3 || noContractInstance}>\n        Check Ring Status\n        </Button>\n      </Form>\n      <Modal isOpen={modalParams.isOpen}>\n        <Card style={{ maxWidth: '620px' }} p={0}>\n          <Button.Text\n            icononly\n            icon={'Close'}\n            color={'moon-gray'}\n            position={'absolute'}\n            top={0}\n            right={0}\n            mt={3}\n            mr={3}\n            onClick={() => {\n              setModalParams(Object.assign({}, modalParams, { isOpen: false }))\n            }}\n          />\n\n          <Box p={4} mb={3}>\n            <div>\n              {\n                modalParams.invalidToken\n                  ? <Text>Invalid hei-token</Text>\n                  : modalParams.withdrawnParticipants === null\n                    ? <Loader style={{ margin: 'auto' }} size='10rem' />\n                    : <div>\n                      <Text>\n                        <strong>Ring status: </strong>{\n                          modalParams.depositedParticipants >= modalParams.maxParticipants || modalParams.ringHash.length === 66\n                            ? 'Closed'\n                            : modalParams.blocksLeftForForceClose > 0\n                              ? `On-going (${modalParams.blocksLeftForForceClose} blocks till manual intervention allowed)`\n                              : `On-going ${modalParams.depositedParticipants > 1 ? '(Intervention allowed)' : ''}`\n                        }\n                        <br />\n                        <strong>Ring participants: </strong> {`${modalParams.depositedParticipants}/${modalParams.maxParticipants}`}\n                        &nbsp;&nbsp;\n                        {\n                          modalParams.depositedParticipants <= 1\n                            ? <Pill color='red'>Privacy not guaranteed</Pill>\n                            : modalParams.depositedParticipants <= 3\n                              ? <Pill color='primary'>Privacy somewhat guaranteed</Pill>\n                              : <Pill color='green'>Privacy strongly guaranteed</Pill>\n                        }\n                      </Text>\n                    </div>\n              }\n            </div>\n          </Box>\n        </Card>\n      </Modal>\n    </div>\n  )\n}\n\nexport default StatusPage\n","// @flow\n\n/* eslint-disable jsx-ally/accessible-emoji */\n\nimport React, { useState, useEffect } from \"react\";\nimport getWeb3 from \"./utils/getWeb3\";\nimport createDrizzleUtils from \"@drizzle-utils/core\";\nimport Web3StatusModal from \"./components/Web3StatusModal\";\nimport Logo from \"./assets/key.png\";\nimport DepositPage from \"./components/DepositPage\";\nimport WithdrawPage from \"./components/WithdrawPage\";\nimport StatusPage from \"./components/StatusPage\";\n\nimport {\n  Heading,\n  Text,\n  Flex,\n  Box,\n  Button,\n  Blockie,\n  QR,\n  Flash,\n  ThemeProvider,\n  Pill,\n  PublicAddress,\n  EthAddress,\n  theme,\n} from \"rimble-ui\";\n\nimport { DappGateway } from \"./types/DappGateway\";\nimport heiswapArtifact from \"./contracts/Heiswap.json\";\n\ntype TabState = {\n  index: number,\n};\n\nconst HeiSwapApp = () => {\n  // Dapp gateway state\n  const [dappGateway: DappGateway, setDappGateway] = useState({\n    web3: null,\n    drizzleUtils: null,\n    ethAddress: null,\n    attempted: false,\n    heiswapInstance: null,\n    heiswapEvent$: null,\n  });\n\n  // Status Modal\n  const [web3StatusModal: Boolean, setweb3StatusModal] = useState(false);\n\n  // \"Tabs\" (made with buttons)\n  const [curTab: TabState, setCurTab] = useState({\n    index: 0,\n  });\n\n  // Helper function to initialize web3, drizzleUtils, and the ETH accounts\n  const initDappGateway = async (): Boolean => {\n    // Already initialized\n    if (\n      dappGateway.web3 !== null &&\n      dappGateway.drizzleUtils !== null &&\n      dappGateway.ethAddress !== null\n    ) {\n      return true;\n    }\n\n    try {\n      const web3 = await getWeb3();\n      const drizzleUtils = await createDrizzleUtils({ web3 });\n      const accounts = await drizzleUtils.getAccounts();\n\n      let heiswapInstance = null;\n      let heiswapEvent$ = null;\n\n      try {\n        heiswapInstance = await drizzleUtils.getContractInstance({\n          artifact: heiswapArtifact,\n        });\n        heiswapEvent$ = await drizzleUtils.createEvent$({\n          artifact: heiswapArtifact,\n        });\n      } catch (err) {\n        heiswapInstance = null;\n        heiswapEvent$ = null;\n      }\n\n      setDappGateway({\n        web3,\n        drizzleUtils,\n        ethAddress: accounts[0],\n        heiswapInstance,\n        heiswapEvent$,\n        attempted: true,\n      });\n\n      // Setup Account Stream\n      drizzleUtils.currentAccount$.subscribe((a) => {\n        if (a !== dappGateway.ethAddress) {\n          setDappGateway(Object.assign({}, dappGateway, { ethAddress: a }));\n        }\n      });\n\n      return true;\n    } catch (err) {\n      setDappGateway(Object.assign({}, dappGateway, { attempted: true }));\n\n      return false;\n    }\n  };\n\n  // On page load, grab web3 and drizzle utils and contract\n  // definitions, as props, and inject them into the browser\n  useEffect(() => {\n    if (\n      (dappGateway.web3 === null || dappGateway.drizzleUtils === null) &&\n      !dappGateway.attempted\n    ) {\n      (async () => {\n        await initDappGateway();\n      })();\n    }\n  });\n\n  // Display warning if no web3 found\n  const noWeb3: boolean =\n    dappGateway.web3 === null &&\n    dappGateway.drizzleUtils === null &&\n    dappGateway.attempted;\n\n  const noContractInstance: boolean =\n    dappGateway.heiswapInstance === null && dappGateway.web3 !== null;\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div style={{ background: \"\", position: \"relative\", minHeight: \"100vh\" }}>\n        <div>\n          <Flex bg=\"#DED9FC\" alignItems=\"center\" mb=\"3\">\n            <Box\n              alignItems=\"center\"\n              p={2}\n              width={1}\n              style={{ textAlign: \"left\" }}\n            >\n              <Heading.h1 fontSize=\"4\" my=\"2\" mx=\"2\">\n                Summer of Shibarium\n              </Heading.h1>\n            </Box>\n\n            <Box\n              alignItems=\"center\"\n              p={2}\n              width={1}\n              style={{ textAlign: \"right\" }}\n            >\n              {dappGateway.ethAddress === null ? (\n                <Button\n                  size=\"medium\"\n                  my=\"1\"\n                  onClick={() => {\n                    if (dappGateway.ethAddress === null) {\n                      (async () => {\n                        if (!(await initDappGateway())) {\n                          setweb3StatusModal(true);\n                        }\n                      })();\n                    }\n                  }}\n                >\n                  Connect\n                </Button>\n              ) : (\n                <Button.Outline\n                  size=\"medium\"\n                  my=\"1\"\n                  onClick={() => setweb3StatusModal(true)}\n                >\n                  <Flex>\n                    <Box mr=\"2\">\n                      <Blockie\n                        opts={{ seed: dappGateway.ethAddress, size: 8 }}\n                      />\n                    </Box>\n                    <Box>\n                      <EthAddress\n                        fontSize=\"2\"\n                        address={dappGateway.ethAddress}\n                        truncate\n                      />\n                    </Box>\n                  </Flex>\n                </Button.Outline>\n              )}\n            </Box>\n          </Flex>\n\n          <Flex>\n            <Box m={\"auto\"} width={[1, 1 / 2]}>\n              <Box mx=\"3\" my=\"3\">\n                <Heading.h2 textAlign=\"center\" mt=\"3\" my=\"3\" fontSize=\"3\">\n                  Move Shiba privately{\" \"}\n                  <span role=\"img\" aria-label=\"moon-face\">\n                    🌚\n                  </span>\n                </Heading.h2>\n                <Text textAlign=\"center\">\n                  Hide your transfers from internet strangers.\n                </Text>\n              </Box>\n\n              <Flex\n                px={4}\n                mx={2}\n                borderColor={\"#E8E8E8\"}\n                justifyContent={\"center\"}\n              >\n                {curTab.index === 0 ? (\n                  <Pill mt={2} color=\"primary\">\n                    <Button.Text mainColor=\"#110C62\">Send</Button.Text>\n                  </Pill>\n                ) : (\n                  <Button.Text\n                    mainColor=\"#988CF0\"\n                    onClick={() => setCurTab({ index: 0 })}\n                  >\n                    Send\n                  </Button.Text>\n                )}\n                {curTab.index === 1 ? (\n                  <Pill mt={2} color=\"primary\">\n                    <Button.Text mainColor=\"#110C62\">Get</Button.Text>\n                  </Pill>\n                ) : (\n                  <Button.Text\n                    mainColor=\"#988CF0\"\n                    onClick={() => setCurTab({ index: 1 })}\n                  >\n                    Get\n                  </Button.Text>\n                )}\n                {/* { curTab.index === 2\n                  ? <Button.Text mainColor=\"#988CF0\">Status</Button.Text>\n                  : <Button.Text mainColor=\"#988CF0\" onClick={() => setCurTab({ index: 2 })}>Status</Button.Text>\n                } */}\n              </Flex>\n\n              {noWeb3 ? (\n                <Flex px={4} py={3} justifyContent={\"stretch\"}>\n                  <Flash variant=\"danger\">\n                    Connect your Ethereum account to continue.\n                  </Flash>\n                </Flex>\n              ) : dappGateway.heiswapInstance === null &&\n                dappGateway.web3 !== null ? (\n                <Flex px={4} py={3} justifyContent={\"stretch\"}>\n                  <Flash variant=\"danger\">\n                    Switch to the Shibarium network to use SOS.\n                  </Flash>\n                </Flex>\n              ) : null}\n\n              <Flex px={4} py={3} justifyContent={\"stretch\"}>\n                {curTab.index === 0 ? (\n                  <DepositPage\n                    dappGateway={dappGateway}\n                    noWeb3={noWeb3}\n                    noContractInstance={noContractInstance}\n                  />\n                ) : curTab.index === 1 ? (\n                  <WithdrawPage\n                    dappGateway={dappGateway}\n                    noWeb3={noWeb3}\n                    noContractInstance={noContractInstance}\n                  />\n                ) : curTab.index === 2 ? (\n                  <StatusPage\n                    dappGateway={dappGateway}\n                    noWeb3={noWeb3}\n                    noContractInstance={noContractInstance}\n                  />\n                ) : (\n                  <div>Invalid Page</div>\n                )}\n              </Flex>\n            </Box>\n          </Flex>\n\n          <Web3StatusModal\n            isOpen={web3StatusModal}\n            setIsOpen={setweb3StatusModal}\n          >\n            {dappGateway.ethAddress === null ? (\n              <div>\n                <Heading.h3>No Ethereum account found</Heading.h3>\n                <br />\n                <Text>\n                  Please visit this page in a Web3 enabled browser.{\" \"}\n                  <a href=\"https://ethereum.org/use/#_3-what-is-a-wallet-and-which-one-should-i-use\">\n                    Learn more\n                  </a>\n                </Text>\n              </div>\n            ) : (\n              <div>\n                <Heading.h3 mb=\"3\">Your connected Ethereum account</Heading.h3>\n                <Text mb=\"3\">\n                  Scan this QR code to send funds to your connected account.\n                </Text>\n                <Box>\n                  <QR value={dappGateway.ethAddress} />\n                </Box>\n                <Box mt=\"3\">\n                  <PublicAddress\n                    my=\"3\"\n                    width=\"100%\"\n                    address={dappGateway.ethAddress}\n                    label=\"Ethereum address\"\n                  />\n                </Box>\n              </div>\n            )}\n          </Web3StatusModal>\n        </div>\n        <div\n          style={{\n            position: \"absolute\",\n            bottom: \"0\",\n            width: \"100%\",\n            height: \"3.5rem\",\n            borderTop: \"1px solid #E8E8E8\",\n          }}\n        >\n          <Text style={{ textAlign: \"center\", paddingTop: \"1rem\" }}>\n            Built by&nbsp;\n            <a href=\"https://summerofshibarium.github.io/sos\">\n              Summer of Shibarium\n            </a>\n          </Text>\n        </div>\n      </div>\n    </ThemeProvider>\n  );\n};\n\nconst App = () => {\n  return <HeiSwapApp />;\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}